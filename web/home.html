<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>AVR-Ada</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="styles.css">
</head>

<body text="#DCDEF2" link="#F0E59E" vlink="#C7B767" alink="#dec3a9" bgcolor="#3A3C69">

<table width="95%" border="0" cellspacing="0" cellpadding="0" align="right">
<tr>
<td width="73%">
<p>&nbsp;</p>
<p>&nbsp;</p>
</td>
<td rowspan="2" width="27%">&nbsp; </td>
</tr>
<tr>
<td width="73%">
<h1>gcc-GNAT on AVR Microcontrollers</h1>
</td>
</tr>
<tr>
<td width="73%">&nbsp;</td>
<td width="27%">&nbsp; </td>
</tr>
<tr>
<td width="73%"><br/><h2>Aim</h2>
The aim of the project is to make the gcc based Ada compiler GNAT
available for AVR microcontrollers.
<p>
More specifically the project provides
<ul>
<li> a GNAT compiler based on the existing AVR and Ada support in
gcc
<li> a minimalistic Ada runtime system
<li> a useful AVR specific support library
</ul></td>
<td width="27%">
<div align="right"></div>
</td>
</tr>
<tr>
<td width="73%"><br/><h2>Status</h2>

<p>The current distribution of AVR-Ada is V0.5.1.  It is based on
 gcc-4.2.1.</p>

<p>In the AVR-Ada project we rarely have problems with the Ada
compiler itself.  It is quite stable. The Ada run time system (RTS) on
the other hand is for the most part not even a <b>run</b> time system.
It is more a compile time system :-).  Most files in the RTS are only
needed at compile time.  As a consequence we don't yet have support
for the following Ada features</p>
<ul>
<li>tasking (multi-threading)</li>
<li>exceptions</li>
<li>returning unconstrained objects from functions</li>
<li>tagged types and run time dispatching</li>
</ul>

<p>There is some AVR specific support.  Type and interface
definitions, timing routines, eeprom access, UART, and most
importantly the necessary definitions for most AVR parts.</p>

<p>Some sample programs show how to use the compiler and the library.
This includes the demo programs from the avr-libc distribution and
some of Peter Fleury's <a
href="http://homepage.hispeed.ch/peterfleury/avr-software.html">example
programs</a> translated to Ada.</p>

<p>The documentation is still low and consists only of the pages here.
Feel free to ask any question on the mailing list.</p>

</td>
<td width="27%">
<div align="right"></div>
</td>
</tr>
<tr>
<td width="73%"><br/><h2>News</h2>
<h3>V 0.5.2 (2007-11-13)</h3>
<ul>

<li>We did the first steps toward full timing support in AVR-Ada. The
best ideas of Ada.Calendar and Ada.Real_Time are now included in
AVR.Real_Time.  A small trick makes these routines available to the
standard RTS und thus enables the standard Ada delay command.</li>

<li>The part description Ada specs are now based on Atmel's XML part
description files of AVR Studio 4.13 build 524.</li>
</ul>

<h3>V 0.4.1 (2006-06-01)</h3>
<ul>
<li>The linker (avr-ld) now generates correct code for avr5 (16k-128K
flash memory) targets when called with the --relax switch (default).</li>

<li>Building static libraries with avr-gnatmake no longer requirers a
host 'gcc' in the search path.</li>

<li>Limited support for new devices: atmega2560 atmega2561 (beta)</li>

<li>mk_ada_app.sh is now working directory independent, and part of
the binary packages (i386-Linux, Windows).</li>

<li>The Linux/Windows binaries are based on gcc-4.1.1, avr-libc-1.4.4
and binutils-2.17.50 and where configured for Ada, C and C++.</li>
<li>avr-mem.sh now recognizes all supported devices.</li>

</ul>
<h3>V 0.4.0 (2006-05-11)</h3>
<ul>
<li>The part description Ada specs are now based on Atmel's XML part
description files of AVR Studio 4.12 build 473 SP 2 + Atmega644p.
 
<li>Limited support for new devices: at90can32 at90can64 at90pwm2 at90pwm3
at90usb1287 atmega1280 atmega1281 atmega164p atmega165 atmega165p
atmega169p atmega324p atmega325 atmega3250 atmega329 atmega3290
atmega406 atmega640 atmega644 atmega644p atmega645 atmega6450
atmega649 atmega6490 attiny24 attiny25 attiny261 attiny44 attiny45
attiny461 attiny84 attiny85 attiny861
 
<li>We build part specific runtime systems (RTS) now. Old Makefiles have
to be adjusted!
 
<li>The AVR-lib has new packages: Watchdog, Sleep, Int_Img. (Note that not
all packages have been ported to all devices).
 
<li>Updated scripts to build AVR-Ada with gcc-3.4.6 and gcc-4.1.0 are now
located in tools/build/.
 
<li>New script (wizard) to generate a ready-to-compile project directory
with all necessary files (tools/mk_ada_app/).
 
<li>New examples (largedemo, debounce) are located in apps/.
 
<li>New bug fixes and workarounds for gcc-3.4 and gcc-4.1 are located in
patches/.

</ul>

<h3>V 0.3.0 (2005-08-03)</h3>
<ul>

<li>The part description spec files are completely new.  The Ada specs
are now generated directly from Atmel's XML part description files of
AVR Studio 4.11 build 406 SP 2.  In previous versions they were
derived from the C header files of avr-libc. </li>

<li>We changed the syntax for accessing single bits from bit numbering to
masks in AVR.IO.  Simple names in the part description specs now
contain bit masks, the pin number is still available with the name
xxx_Bit.  E.g.:</li>
 
<p><code>-- <i> Port D Data Register bit 3</i><br>
PORTD3_Bit&nbsp;&nbsp;: <b>constant</b> Bit_Number := 3;<br>
PORTD3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <b>constant</b> Byte&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= 16#08#;</code></p>
 
<li>The previous Set_IO routines in AVR.IO were renamed to simply Put
omitting the _IO, the Get_IO have become Get.  That is more in the
style of other Ada IO packages like Text_IO.</li>

<li>New packages for string handling and accessing constants in program
space.  They are actually a stripped down version of
Ada.Strings.Bounded.</li>

<li>We build part specific libraries now.  That means that we can provide
specific functionality adapted to a given part.  It is currently used
for the UART and EEPROM access only, though.</li>

<li>The example programs for accessing a 1-wire devices and an LCD are not
part of the distributions anymore.  They are only available via CVS.
There is also starting support for the atmega169 based AVR Butterfly
in the CVS repository (UART, LCD, and dataflash).</li>
</ul>

<h3>V 0.2.0 (2004-10-28)</h3>
<ul>
<li>We modified the compiler patches to fit cleanly to gcc-3.4.3.  They
probably also fit in previous gcc-3.4.x releases; I never tried.</li>

<li>The "freestanding" patch is now considerably shorter since part of
what it does (avoid some code in the binder file) is now provided
directly in gcc. The corresponding binder options was previously
called "standalone", but that expression is used elsewhere in
GNAT.</li> 

<li>You can now use "Library Projects" with AVR-Ada. I.e. you can have
gpr files with "Library_Name", etc.  The only permitted value for
"Library_Kind" is "static".  This feature is used for the Avr library. 
</ul>
</td>
<td>
<div align="right"></div>
</td>
</tr>
<tr>
<td width="73%"><br/><h2>Supported Devices</h2>
<p>We distinguish between primary devices and supported devices.
Primary devices are used by the developers of AVR-Ada.  The sample
programs and the library have been tested with primary devices
only.</p>

<p>at90s2313 at90s8515 atmega162 atmega169</p>

<p>Supported devices only have a stripped down support library.  If
you want to use one of them, drop us a note on the mailing list and we
make it a primary device.  If your preferred device is not listed
here, then also drop us a note and we shall include it.</p>

<p>
at90can128
at90can32
at90can64
at90pwm2
at90pwm3
at90s2313
at90s2323
at90s2343
at90s4414
at90s4433
at90s4434
at90s8515
at90s8535
at90usb1287
atmega103
atmega128
atmega1280
atmega1281
atmega16
atmega161
atmega162
atmega163
atmega164p
atmega165
atmega165p
atmega168
atmega169
atmega169p
atmega2560
atmega2561
atmega32
atmega323
atmega324p
atmega325
atmega3250
atmega329
atmega3290
atmega406
atmega48
atmega64
atmega640
atmega644
atmega644p
atmega645
atmega6450
atmega649
atmega6490
atmega8
atmega8515
atmega8535
atmega88
attiny13
attiny22
attiny2313
attiny24
attiny25
attiny26
attiny261
attiny44
attiny45
attiny461
attiny85
attiny861
</td>
<td>
<div align="right"></div>
</td>
</tr>

<tr>
<td width="73%"><br/><h2>Host Environment</h2>

<p>Most of the project members use Linux or Windows as their host
system.  I now managed to reliably build gcc on MinGW/Msys and use
that most of the time.  It is possible that the next release of <a
href="http://winavr.sourceforge.net/" target="_parent">WinAVR</a> will
include a binary copy of AVR-Ada.</td>

<td width="27%">
<div align="right"></div>
</td>
</tr>
<tr>
<td width="73%">
<p>&nbsp;</p>
<p>&nbsp;</p>
</td>
<td width="27%">
</td>
</tr>
</table>

</body>
</html>
